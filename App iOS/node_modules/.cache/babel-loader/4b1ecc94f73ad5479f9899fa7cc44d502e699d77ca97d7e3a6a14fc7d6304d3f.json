{"ast":null,"code":"import{IonButton,IonContent,IonToolbar,IonHeader,IonImg,IonLabel,IonPage,IonTitle,IonDatetime}from'@ionic/react';import React,{useEffect,useState}from'react';import{ReactSVG}from'react-svg';import{BleClient,textToDataView}from'@capacitor-community/bluetooth-le';import{BLE}from'@ionic-native/ble';import'./Temporizador.css';import TituloTiempo from'../imagenes/titulotiempo.svg';import Volver from'../imagenes/volver.svg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const HEART_RATE_SERVICE='0000abcd-0000-1000-8000-00805f9b34fb';const WRITE_CHARACTERISTIC2=\"00004321-0000-1000-8000-00805F9B34FB\";function Home(){const[currentTime,setCurrentTime]=useState('');useEffect(()=>{const interval=setInterval(()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);}if(peripherals.length<=0){window.location.href='/Dispositivos';}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});},2000);const getCurrentTime=()=>{const date=new Date();const hours=date.getHours().toString().padStart(2,'0');const minutes=date.getMinutes().toString().padStart(2,'0');const timeStr=`${hours}:${minutes}`;setCurrentTime(timeStr);};// Obtener la hora actual al cargar el componente\ngetCurrentTime();// Actualizar la hora actual cada minuto\nconst interval2=setInterval(()=>{getCurrentTime();},30000);// Limpiar el intervalo cuando se desmonte el componente\nreturn()=>{clearInterval(interval2);};},[]);const[selectedDate,setSelectedDate]=useState('');const handleDateChange=event=>{setSelectedDate(event.target.value);};const handleClick1=()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);const todo=selectedDate.slice(11,16)+currentTime;await BleClient.write(peripherals[i].id,HEART_RATE_SERVICE,WRITE_CHARACTERISTIC2,textToDataView(selectedDate.slice(11,16)+currentTime));console.log('Fecha seleccionada:',todo);console.log('Fecha real:',selectedDate.slice(11,16));}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});};const handleClick2=()=>{console.log(selectedDate.slice(11,16),currentTime);};function back(){window.location.href='/Menu';}return/*#__PURE__*/_jsxs(IonPage,{children:[/*#__PURE__*/_jsx(IonHeader,{className:\"fondoTiempo\",children:/*#__PURE__*/_jsx(IonToolbar,{className:\"fondoTiempo\",children:/*#__PURE__*/_jsx(ReactSVG,{src:TituloTiempo})})}),/*#__PURE__*/_jsxs(IonContent,{fullscreen:true,className:\"fondoTiempo\",children:[/*#__PURE__*/_jsx(IonLabel,{className:\"tituloSeleccionar\",children:\"Seleccione una hora: \"}),/*#__PURE__*/_jsx(IonDatetime,{presentation:\"time\",value:selectedDate,onIonChange:handleDateChange,className:\"timer\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"contenedor-buttons\",children:[/*#__PURE__*/_jsx(IonButton,{onClick:handleClick1,className:\"buttons\",color:\"#797979\",children:\"Abrir\"}),/*#__PURE__*/_jsx(IonButton,{onClick:handleClick2,className:\"buttons\",color:\"var(--color-personalizado)\",children:\"Cerrar\"})]}),/*#__PURE__*/_jsx(ReactSVG,{src:Volver,className:\"imgAtras2\",onClick:back})]})]});};export default Home;","map":{"version":3,"names":["IonButton","IonContent","IonToolbar","IonHeader","IonImg","IonLabel","IonPage","IonTitle","IonDatetime","React","useEffect","useState","ReactSVG","BleClient","textToDataView","BLE","TituloTiempo","Volver","jsx","_jsx","jsxs","_jsxs","HEART_RATE_SERVICE","WRITE_CHARACTERISTIC2","Home","currentTime","setCurrentTime","interval","setInterval","connectedPeripheralsWithServices","then","peripherals","console","log","i","length","id","window","location","href","error","getCurrentTime","date","Date","hours","getHours","toString","padStart","minutes","getMinutes","timeStr","interval2","clearInterval","selectedDate","setSelectedDate","handleDateChange","event","target","value","handleClick1","todo","slice","write","handleClick2","back","children","className","src","fullscreen","presentation","onIonChange","onClick","color"],"sources":["/Users/Misana/Desktop/Borja/src/pages/Temporizador.jsx"],"sourcesContent":["import { IonButton, IonContent, IonToolbar, IonHeader, IonImg, IonLabel, IonPage, IonTitle, IonDatetime } from '@ionic/react';\nimport React, { useEffect, useState } from 'react';\nimport { ReactSVG } from 'react-svg';\nimport { BleClient, textToDataView } from '@capacitor-community/bluetooth-le';\nimport { BLE } from '@ionic-native/ble';\n\nimport './Temporizador.css';\n\nimport TituloTiempo from '../imagenes/titulotiempo.svg'\nimport Volver from '../imagenes/volver.svg'\n\nconst HEART_RATE_SERVICE = '0000abcd-0000-1000-8000-00805f9b34fb';\nconst WRITE_CHARACTERISTIC2 = \"00004321-0000-1000-8000-00805F9B34FB\"\n\nfunction Home () {\n  const [currentTime, setCurrentTime] = useState('');\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n          }\n\n          if(peripherals.length <= 0){\n            window.location.href ='/Dispositivos';\n          }\n\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n\n    }, 2000);\n\n    const getCurrentTime = () => {\n      const date = new Date();\n      const hours = date.getHours().toString().padStart(2, '0');\n      const minutes = date.getMinutes().toString().padStart(2, '0');\n      const timeStr = `${hours}:${minutes}`;\n      setCurrentTime(timeStr);\n    };\n\n    // Obtener la hora actual al cargar el componente\n    getCurrentTime();\n\n    // Actualizar la hora actual cada minuto\n    const interval2 = setInterval(() => {\n      getCurrentTime();\n    }, 30000);\n\n    // Limpiar el intervalo cuando se desmonte el componente\n    return () => {\n      clearInterval(interval2);\n    };\n\n  }, []);\n\n    const [selectedDate, setSelectedDate] = useState('');\n\n    const handleDateChange = (event) => {\n        setSelectedDate(event.target.value);\n      };\n    \n    const handleClick1 = () => {\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n            const todo = selectedDate.slice(11, 16) + currentTime;\n            await BleClient.write(peripherals[i].id, HEART_RATE_SERVICE, WRITE_CHARACTERISTIC2, textToDataView(selectedDate.slice(11, 16) + currentTime));\n            console.log('Fecha seleccionada:', todo);\n            console.log('Fecha real:', selectedDate.slice(11, 16));\n          }\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n    };  \n\n    const handleClick2 = () => {\n      console.log(selectedDate.slice(11, 16), currentTime);\n    };  \n\n  function back(){\n    window.location.href ='/Menu';\n  }\n\n  return (\n    <IonPage>\n        <IonHeader className='fondoTiempo'>\n          <IonToolbar className='fondoTiempo'>\n            <ReactSVG src={TituloTiempo}></ReactSVG>\n          </IonToolbar>\n        </IonHeader>\n\n      <IonContent fullscreen className='fondoTiempo'>\n\n        <IonLabel className='tituloSeleccionar'>Seleccione una hora: </IonLabel>\n\n        <IonDatetime presentation='time' value={selectedDate} onIonChange={handleDateChange} className='timer'></IonDatetime>\n\n        <div className='contenedor-buttons'>\n          <IonButton onClick={handleClick1} className='buttons' color='#797979'>Abrir</IonButton>\n          <IonButton onClick={handleClick2} className='buttons' color=\"var(--color-personalizado)\">Cerrar</IonButton>\n        </div>\n\n        <ReactSVG src={Volver} className='imgAtras2' onClick={back}></ReactSVG>\n\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}