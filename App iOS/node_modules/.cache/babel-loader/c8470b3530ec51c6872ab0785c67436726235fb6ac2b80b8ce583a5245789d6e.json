{"ast":null,"code":"import{IonButton,IonContent,IonToolbar,IonHeader,IonLabel,IonPage,IonDatetime}from'@ionic/react';import React,{useEffect,useState}from'react';import{ReactSVG}from'react-svg';import{BleClient,textToDataView}from'@capacitor-community/bluetooth-le';import{BLE}from'@ionic-native/ble';import'./Temporizador.css';import TituloTiempo from'../imagenes/titulotiempo.svg';import Volver from'../imagenes/volver.svg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const HEART_RATE_SERVICE='0000abcd-0000-1000-8000-00805f9b34fb';const WRITE_CHARACTERISTIC2=\"00004321-0000-1000-8000-00805F9B34FB\";function Home(){const[currentTime,setCurrentTime]=useState('');const[selectedDate,setSelectedDate]=useState(null);useEffect(()=>{console.log(selectedDate);const interval=setInterval(()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);}if(peripherals.length<=0){window.location.href='/Dispositivos';}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});},2000);const getCurrentTime=()=>{const date=new Date();const hours=date.getHours().toString().padStart(2,'0');const minutes=date.getMinutes().toString().padStart(2,'0');const seconds=date.getSeconds().toString().padStart(2,'0');const timeStr=`${hours}:${minutes}:${seconds}`;setCurrentTime(timeStr);};getCurrentTime();const interval2=setInterval(()=>{getCurrentTime();},30000);return()=>{clearInterval(interval2);};},[]);const cambios=event=>{setSelectedDate(event.target.value);};const abrir=()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);await BleClient.write(peripherals[i].id,HEART_RATE_SERVICE,WRITE_CHARACTERISTIC2,textToDataView(selectedDate.slice(11,16)+\" \"+currentTime+\" 1\"));}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});};const cerrar=()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);await BleClient.write(peripherals[i].id,HEART_RATE_SERVICE,WRITE_CHARACTERISTIC2,textToDataView(selectedDate.slice(11,16)+\" \"+currentTime+\" 0\"));}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});};function back(){window.location.href='/Menu';}function Mostrar(){if(selectedDate!=null){return/*#__PURE__*/_jsxs(\"div\",{className:\"contenedor-buttons\",children:[/*#__PURE__*/_jsx(IonButton,{onClick:abrir,className:\"buttons\",color:\"#797979\",children:\"Abrir\"}),/*#__PURE__*/_jsx(IonButton,{onClick:cerrar,className:\"buttons\",color:\"var(--color-personalizado)\",children:\"Cerrar\"})]});}else{return/*#__PURE__*/_jsx(\"h1\",{className:\"h2\",children:\"Ninguna hora seleccionada\"});}}return/*#__PURE__*/_jsxs(IonPage,{children:[/*#__PURE__*/_jsx(IonHeader,{className:\"fondoTiempo\",children:/*#__PURE__*/_jsx(IonToolbar,{className:\"fondoTiempo\",children:/*#__PURE__*/_jsx(ReactSVG,{src:TituloTiempo})})}),/*#__PURE__*/_jsxs(IonContent,{fullscreen:true,className:\"fondoTiempo\",children:[/*#__PURE__*/_jsx(IonLabel,{className:\"tituloSeleccionar\",children:\"Seleccione una hora: \"}),/*#__PURE__*/_jsx(IonDatetime,{presentation:\"time\",value:selectedDate,onIonChange:cambios,className:\"timer\"}),/*#__PURE__*/_jsx(Mostrar,{}),/*#__PURE__*/_jsx(ReactSVG,{src:Volver,className:\"imgAtras2\",onClick:back})]})]});};export default Home;","map":{"version":3,"names":["IonButton","IonContent","IonToolbar","IonHeader","IonLabel","IonPage","IonDatetime","React","useEffect","useState","ReactSVG","BleClient","textToDataView","BLE","TituloTiempo","Volver","jsx","_jsx","jsxs","_jsxs","HEART_RATE_SERVICE","WRITE_CHARACTERISTIC2","Home","currentTime","setCurrentTime","selectedDate","setSelectedDate","console","log","interval","setInterval","connectedPeripheralsWithServices","then","peripherals","i","length","id","window","location","href","error","getCurrentTime","date","Date","hours","getHours","toString","padStart","minutes","getMinutes","seconds","getSeconds","timeStr","interval2","clearInterval","cambios","event","target","value","abrir","write","slice","cerrar","back","Mostrar","className","children","onClick","color","src","fullscreen","presentation","onIonChange"],"sources":["/Users/Misana/Desktop/Borja/src/pages/Temporizador.jsx"],"sourcesContent":["import { IonButton, IonContent, IonToolbar, IonHeader, IonLabel, IonPage, IonDatetime } from '@ionic/react';\nimport React, { useEffect, useState } from 'react';\nimport { ReactSVG } from 'react-svg';\nimport { BleClient, textToDataView } from '@capacitor-community/bluetooth-le';\nimport { BLE } from '@ionic-native/ble';\n\nimport './Temporizador.css';\n\nimport TituloTiempo from '../imagenes/titulotiempo.svg'\nimport Volver from '../imagenes/volver.svg'\n\nconst HEART_RATE_SERVICE = '0000abcd-0000-1000-8000-00805f9b34fb';\nconst WRITE_CHARACTERISTIC2 = \"00004321-0000-1000-8000-00805F9B34FB\"\n\nfunction Home () {\n\n  const [currentTime, setCurrentTime] = useState('');\n  const [selectedDate, setSelectedDate] = useState(null);\n\n  useEffect(() => {\n    console.log(selectedDate);\n    const interval = setInterval(() => {\n\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n          }\n\n          if(peripherals.length <= 0){\n            window.location.href ='/Dispositivos';\n          }\n\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n\n    }, 2000);\n\n    const getCurrentTime = () => {\n      const date = new Date();\n      const hours = date.getHours().toString().padStart(2, '0');\n      const minutes = date.getMinutes().toString().padStart(2, '0');\n      const seconds = date.getSeconds().toString().padStart(2, '0');\n      const timeStr = `${hours}:${minutes}:${seconds}`;\n      setCurrentTime(timeStr);\n    };\n    getCurrentTime();\n\n    const interval2 = setInterval(() => {\n      getCurrentTime();\n    }, 30000);\n\n    return () => {\n      clearInterval(interval2);\n    };\n\n  }, []);\n\n    const cambios = (event) => {\n        setSelectedDate(event.target.value);\n      };\n    \n    const abrir = () => {\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n            await BleClient.write(peripherals[i].id, HEART_RATE_SERVICE, WRITE_CHARACTERISTIC2, textToDataView(selectedDate.slice(11, 16) + \" \" + currentTime + \" 1\"));\n          }\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n    };  \n\n    const cerrar = () => {\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n            await BleClient.write(peripherals[i].id, HEART_RATE_SERVICE, WRITE_CHARACTERISTIC2, textToDataView(selectedDate.slice(11, 16) + \" \" + currentTime + \" 0\"));\n          }\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );    };  \n\n  function back(){\n    window.location.href ='/Menu';\n  }\n\n  function Mostrar(){\n\n    if(selectedDate != null){\n      return(\n        <div className='contenedor-buttons'>\n          <IonButton onClick={abrir} className='buttons' color='#797979'>Abrir</IonButton>\n          <IonButton onClick={cerrar} className='buttons' color=\"var(--color-personalizado)\">Cerrar</IonButton>\n        </div>\n      )\n    }else{\n      return(\n        <h1 className='h2'>Ninguna hora seleccionada</h1>\n      )\n    }\n\n  }\n\n  return (\n    <IonPage>\n        <IonHeader className='fondoTiempo'>\n          <IonToolbar className='fondoTiempo'>\n            <ReactSVG src={TituloTiempo}></ReactSVG>\n          </IonToolbar>\n        </IonHeader>\n\n      <IonContent fullscreen className='fondoTiempo'>\n\n        <IonLabel className='tituloSeleccionar'>Seleccione una hora: </IonLabel>\n\n        <IonDatetime presentation='time' value={selectedDate} onIonChange={cambios} className='timer'></IonDatetime>\n\n        <Mostrar/>\n\n        <ReactSVG src={Volver} className='imgAtras2' onClick={back}></ReactSVG>\n\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}