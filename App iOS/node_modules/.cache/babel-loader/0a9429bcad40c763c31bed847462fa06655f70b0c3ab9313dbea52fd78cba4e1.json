{"ast":null,"code":"import{IonButton,IonContent,IonFooter,IonHeader,IonImg,IonCheckbox,IonPage,IonTitle,IonToolbar}from'@ionic/react';import'./Lluvia.css';import{ReactSVG}from'react-svg';import{BleClient,numbersToDataView}from'@capacitor-community/bluetooth-le';import{BLE}from'@ionic-native/ble';import{useEffect,useState}from'react';import Lluvia from'../imagenes/titulolluvia.svg';import Volver from'../imagenes/volver.svg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Home(){const HEART_RATE_SERVICE='0000abcd-0000-1000-8000-00805f9b34fb';const READ_CHARACTERISTIC=\"00001111-0000-1000-8000-00805F9B34FB\";const WRITE_CHARACTERISTIC=\"00001111-0000-1000-8000-00805F9B34FB\";const[isChecked,setIsChecked]=useState(false);useEffect(()=>{const interval=setInterval(()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);}if(peripherals.length<=0){window.location.href='/Dispositivos';}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});},1000);},[]);const guardar=event=>{setIsChecked(event.target.value);if(isChecked==false){setIsChecked(true);console.log(\"Seteado true\");BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);await BleClient.write(peripherals[i].id,HEART_RATE_SERVICE,WRITE_CHARACTERISTIC,numbersToDataView([1]));}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});}else if(isChecked==true){setIsChecked(false);console.log(\"Seteado false\");BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);await BleClient.write(peripherals[i].id,HEART_RATE_SERVICE,WRITE_CHARACTERISTIC,numbersToDataView([0]));}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});}};useEffect(()=>{BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});setTimeout(comprobar,20);function comprobar(){BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(async peripherals=>{console.log('Dispositivos conectados con el servicio '+HEART_RATE_SERVICE+':');for(let i=0;i<peripherals.length;i++){console.log(peripherals[i].id);const estado=await BleClient.read(peripherals[i].id,HEART_RATE_SERVICE,READ_CHARACTERISTIC);console.log('ESTADO:',estado.getUint8(0));if(estado.getUint8(0)==0){setIsChecked(false);}else if(estado.getUint8(0)==1){setIsChecked(true);}}},error=>{console.log('Error al buscar dispositivos conectados: '+error);});}},[]);function back(){window.location.href='/Menu';}function cambiarValor(){if(isChecked==true){setIsChecked(false);}else if(isChecked==false){setIsChecked(true);}}return/*#__PURE__*/_jsxs(IonPage,{children:[/*#__PURE__*/_jsx(IonHeader,{className:\"fondoLluvia\",children:/*#__PURE__*/_jsx(IonToolbar,{className:\"fondoLluvia\",children:/*#__PURE__*/_jsx(ReactSVG,{src:Lluvia})})}),/*#__PURE__*/_jsxs(IonContent,{fullscreen:true,className:\"fondo\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"texto\",children:\"Con nuestra funci\\xF3n de control basada en la lluvia, puedes decidir c\\xF3mo quieres que tus dispositivos respondan cuando detecten lluvia.\"}),/*#__PURE__*/_jsx(IonCheckbox,{className:\"checkbox\",checked:isChecked,onIonChange:guardar,children:\"Cerrar en caso de lluvia\"}),/*#__PURE__*/_jsx(ReactSVG,{src:Volver,className:\"imgAtras3\",onClick:back})]})]});};export default Home;","map":{"version":3,"names":["IonButton","IonContent","IonFooter","IonHeader","IonImg","IonCheckbox","IonPage","IonTitle","IonToolbar","ReactSVG","BleClient","numbersToDataView","BLE","useEffect","useState","Lluvia","Volver","jsx","_jsx","jsxs","_jsxs","Home","HEART_RATE_SERVICE","READ_CHARACTERISTIC","WRITE_CHARACTERISTIC","isChecked","setIsChecked","interval","setInterval","connectedPeripheralsWithServices","then","peripherals","console","log","i","length","id","window","location","href","error","guardar","event","target","value","write","setTimeout","comprobar","estado","read","getUint8","back","cambiarValor","children","className","src","fullscreen","checked","onIonChange","onClick"],"sources":["/Users/Misana/Desktop/Borja/src/pages/Lluvia.jsx"],"sourcesContent":["import { IonButton, IonContent, IonFooter, IonHeader, IonImg, IonCheckbox, IonPage, IonTitle, IonToolbar } from '@ionic/react';\nimport './Lluvia.css';\nimport { ReactSVG } from 'react-svg';\nimport { BleClient, numbersToDataView } from '@capacitor-community/bluetooth-le';\nimport { BLE } from '@ionic-native/ble';\nimport { useEffect, useState } from 'react';\n\n\nimport Lluvia from '../imagenes/titulolluvia.svg';\nimport Volver from '../imagenes/volver.svg'\n\nfunction Home () {\n\n  const HEART_RATE_SERVICE = '0000abcd-0000-1000-8000-00805f9b34fb';\n  const READ_CHARACTERISTIC = \"00001111-0000-1000-8000-00805F9B34FB\";\n  const WRITE_CHARACTERISTIC = \"00001111-0000-1000-8000-00805F9B34FB\";\n\n  const [isChecked, setIsChecked] = useState(false);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n          }\n\n          if(peripherals.length <= 0){\n            window.location.href ='/Dispositivos';\n          }\n\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n\n    }, 1000);\n\n  }, []);\n\n  const guardar = (event) => {\n    \n    setIsChecked(event.target.value);\n\n    if(isChecked == false){\n      setIsChecked(true);\n      console.log(\"Seteado true\");\n\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n            await BleClient.write(peripherals[i].id, HEART_RATE_SERVICE, WRITE_CHARACTERISTIC, numbersToDataView([1]));\n          }\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n\n    }else if(isChecked == true){\n      setIsChecked(false);\n      console.log(\"Seteado false\");\n\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n            await BleClient.write(peripherals[i].id, HEART_RATE_SERVICE, WRITE_CHARACTERISTIC, numbersToDataView([0]));\n          }\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n      \n    }\n\n  }\n\n  useEffect(() => {\n    \n    BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n      async peripherals => {\n        console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n        for(let i = 0; i < peripherals.length; i++) {\n          console.log(peripherals[i].id);       \n        }\n      },\n      error => {\n        console.log('Error al buscar dispositivos conectados: ' + error);\n      }\n    );\n\n    setTimeout(comprobar, 20);\n\n    function comprobar(){\n      BLE.connectedPeripheralsWithServices([HEART_RATE_SERVICE]).then(\n        async peripherals => {\n          console.log('Dispositivos conectados con el servicio ' + HEART_RATE_SERVICE + ':');\n          for(let i = 0; i < peripherals.length; i++) {\n            console.log(peripherals[i].id);\n            const estado = await BleClient.read(peripherals[i].id, HEART_RATE_SERVICE, READ_CHARACTERISTIC);\n            console.log('ESTADO:', estado.getUint8(0));   \n            if(estado.getUint8(0) == 0){\n              setIsChecked(false)\n            }else if(estado.getUint8(0) == 1){\n              setIsChecked(true)\n            }\n          }\n        },\n        error => {\n          console.log('Error al buscar dispositivos conectados: ' + error);\n        }\n      );\n    }\n\n  }, []);\n\n    function back(){\n      window.location.href ='/Menu';\n    }\n    \n    function cambiarValor(){\n      if(isChecked == true){\n        setIsChecked(false)\n      }else if(isChecked == false){\n        setIsChecked(true)\n      }\n    }\n    \n  return (\n    <IonPage>\n\n        <IonHeader className='fondoLluvia'>\n          <IonToolbar className='fondoLluvia'>\n            <ReactSVG src={Lluvia}></ReactSVG>\n          </IonToolbar>\n        </IonHeader>\n\n\n      <IonContent fullscreen className='fondo'>\n\n        <h2 className='texto'>Con nuestra función de control basada en la lluvia, puedes decidir cómo quieres que tus dispositivos respondan cuando detecten lluvia.</h2>\n        <IonCheckbox className='checkbox' checked={isChecked} onIonChange={guardar}>Cerrar en caso de lluvia</IonCheckbox>\n        <ReactSVG src={Volver} className='imgAtras3' onClick={back}></ReactSVG>\n\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Home;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}